<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Consulta - Picking by Box</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: #f5f7fa;
      }
      .status-card {
        border: 0;
        border-radius: 14px;
        box-shadow: 0 8px 28px rgba(0, 0, 0, 0.06);
      }
      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
      }
      .table thead th {
        position: sticky;
        top: 0;
        z-index: 2;
        background: #fff;
      }
      .pill {
        border-radius: 999px;
        padding: 0.35rem 0.6rem;
        font-weight: 700;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        white-space: nowrap;
      }
      .pill small {
        font-weight: 600;
        opacity: 0.9;
      }
      .pill-gray {
        background: #eef1f4;
        color: #1a1d20;
      }
      .pill-blue {
        background: #e7f1ff;
        color: #0b5ed7;
      }
      .pill-green {
        background: #e8fff1;
        color: #146c43;
      }
      .pill-yellow {
        background: #fff6dd;
        color: #8a5a00;
      }
      .pill-red {
        background: #ffe8ea;
        color: #b02a37;
      }
      .clickable-row {
        cursor: pointer;
      }
      .clickable-row:hover {
        background: rgba(13, 110, 253, 0.04);
      }
      .muted-small {
        font-size: 0.85rem;
        color: #5b6470;
      }
    </style>
  </head>

  <body class="p-3 p-md-4">
    <div class="container-fluid">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <h3 class="mb-0">ðŸ”Ž Consulta de Pedidos</h3>
          <div class="muted-small">
            Panorama: separaÃ§Ã£o â†’ romaneio â†’ NL â†’ pesagem â†’ coleta
          </div>
        </div>

        <div class="d-flex gap-2">
          <button id="btnRecarregar" class="btn btn-outline-dark btn-sm">
            <i class="bi bi-arrow-repeat"></i> Recarregar
          </button>
          <a href="/index.html" class="btn btn-dark btn-sm">
            <i class="bi bi-box-arrow-left"></i> Voltar
          </a>
        </div>
      </div>

      <!-- FILTROS -->
      <div class="card status-card mb-3">
        <div class="card-body">
          <div class="row g-2 align-items-end">
            <div class="col-6 col-md-2">
              <label class="form-label">Pedido inÃ­cio</label>
              <input id="pedidoIni" class="form-control" type="text" />
            </div>
            <div class="col-6 col-md-2">
              <label class="form-label">Pedido fim</label>
              <input id="pedidoFim" class="form-control" type="text" />
            </div>
            <div class="col-6 col-md-3">
              <label class="form-label">Data inÃ­cio</label>
              <input id="dataIni" class="form-control" type="date" />
            </div>
            <div class="col-6 col-md-3">
              <label class="form-label">Data fim</label>
              <input id="dataFim" class="form-control" type="date" />
            </div>
            <div class="col-12 col-md-2 d-grid">
              <button id="btnBuscar" class="btn btn-primary">
                <i class="bi bi-search"></i> Buscar
              </button>
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Filtrar por status</label>
              <select id="filtroStatus" class="form-select">
                <option value="">Todos</option>
                <option value="AGUARDANDO SEPARAÃ‡ÃƒO">
                  Aguardando SeparaÃ§Ã£o
                </option>
                <option value="SEPARANDO">Separando</option>
                <option value="SEPARADO">Separado</option>
                <option value="DESPACHANDO">Despachando</option>
                <option value="AGUARDANDO COMPLETAR">
                  Aguardando Completar
                </option>
                <option value="AGUARDANDO COLETA">Aguardando Coleta</option>
                <option value="COLETADO">Coletado</option>
              </select>
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Filtrar por mÃ©todo envio</label>
              <input
                id="filtroMetodo"
                class="form-control"
                type="text"
                placeholder="Ex: SEDEX, LOGGI..."
              />
            </div>

            <div class="col-12 col-md-3">
              <label class="form-label">Buscar por cliente</label>
              <input
                id="filtroCliente"
                class="form-control"
                type="text"
                placeholder="Parte do nome"
              />
            </div>

            <div class="col-12 col-md-3 d-grid">
              <button id="btnLimpar" class="btn btn-outline-secondary">
                <i class="bi bi-eraser"></i> Limpar filtros
              </button>
            </div>

            <div class="col-12">
              <div id="hint" class="muted-small"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- CARDS RESUMO -->
      <div class="row g-2 mb-3" id="cardsResumo"></div>

      <!-- TABELA -->
      <div class="card status-card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="muted-small">
              <span class="mono" id="infoQtd">0</span> pedidos
            </div>
            <button id="btnCopiarLista" class="btn btn-outline-primary btn-sm">
              <i class="bi bi-clipboard"></i> Copiar lista (pedido + status)
            </button>
          </div>

          <div class="table-responsive" style="max-height: 68vh">
            <table class="table table-sm table-striped align-middle">
              <thead>
                <tr>
                  <th>Pedido</th>
                  <th>Data</th>
                  <th>Status</th>
                  <th>Romaneio</th>
                  <th class="text-center">SeparaÃ§Ã£o</th>
                  <th class="text-center">NL</th>
                  <th class="text-center">Pesagem</th>
                  <th class="text-center">Coleta</th>
                  <th>MÃ©todo</th>
                  <th>Cliente</th>
                </tr>
              </thead>
              <tbody id="tbodyConsulta"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal detalhe -->
    <div class="modal fade" id="modalDetalhe" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Detalhes do Pedido</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Fechar"
            ></button>
          </div>
          <div class="modal-body">
            <div id="detalheBody"></div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="modules/consulta.js"></script>
  </body>
</html>
